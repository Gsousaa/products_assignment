# Products Assignment

[![N|Solid](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAACoCAMAAABt9SM9AAAA8FBMVEX/////0kI3c6U3dKf/00P/0EA3cKD/10j/1UU3d6w3dKb/zj7/2Ur/zDv/yjk2bpw4erE2a5f/3U/a4en/+/DL1+T/31Cnus7/6K7/1VL/565Ygqr/4GiIqMgjbqf/zDEpaJpYircWaaP/1DP/zzT/3Gr/z0z/yCIWaqX/1z4oZZX/3pYrdK7u8fUtbJ//4m7/4Ym1x9uet9L/9t7/33/X4ez/+OhkjLL/2V3/3Dv/46P/0mT/xBL/6LmVsc9ul8BrkLV9ocVGgLH/8MN3lLL/7sgOWYqHoLmbr8T/6pv/5ob/4Fz/1nL/7KP/79D/2YEy9IW6AAAJ2ElEQVR4nO3dC1faPBgHcJGrY1QQ8DZosa0WELqBg4miU5zu+ur3/zZv723atAkFktjyP2eezbNzoL+Tpk+TNN3Z2WabZGdYnzRHo/G4bWU8Pho1J/Uh7e/FWCaj++8LvstrGbjZ0//Ni6K4+H4/qtP+jixkOGovujrRXrVa3YMmm83qaGfjJu0vSzXD8Vl3MKjaCbUyo4E9jGh/ZVoZaVJVTxBWenZV8XFC+3tTyNEAkMKy+vDhQ1YVP6XtdGxWfVS4Vtnd3V3xU6qukI/danyrXe1kHNM+AmIZBprVclY6V1oa1zBAtbSVprWbDq11WGnppEHrDKwX4loVCgXaR7L5jLxWg271jO8O4lmpD7SPZePxUlWNgnzY7saxKhQ6SS+4mrxr9Wj/sh5oWzhWWtuieSQE0h4ErbTGxcexSnzTOnMblvfXIz6GVUH9RuswyMS1AotwPoZVoSBSOgpCcbB4cPTgcRDDKunnoYsF1pRjPoZVoZPs8S0k1jJWhc4vSodBJqjTEGGVLqxFdAe/nFWhc0TpMMjELh32oKXDklYpwdJgIEXpslbpwDJoeEcrrlUqsKwL32Bh3kjfd2NapQHLrdX57t5Zthu3XaUBKzgeE9cq8VjQkb6YVonHWqfVfiqxYlqlEiuuVRqxYlulECu+VfqwVrBKOtaia0YU9T/hwbJKOhZuRByr/f4WS4+IY7XFMiPiWG2xzIg4VlssMyKOlYXVuDkG8nRF+9vHSL05GjXjZdLBsbKxpB4YSTp/on3wy6R5v+gaz0vwWFFV1fhhptPBs3KwPpopOilJ0g1tAswMxwP8ZwFi1KIhWB4rLT3pXbSuMfAwwAatQCzQSov0lbYEMpPqss9NxLYCsAJWpZJ8QhsDkTG4xH2jVl4siFWplCvS5ojMI0/QquZiQa00LZbb1vcBSSsXK8SqlJPPaZOE5pGsFQTLZ5XLSce0UUIyItlf1TxY4Vaa1pQ2CzR10lYBLIhVLn9N2wWaBWkrPxbMKpORWSxOx+TqK8vKhwW3ymRytGUg4YlbgVhhViw2rXtS9ziuVQSWxyqTZ6/Y6pK3ArBCrbSmxdoA19GAvJUXK8IqI3+hreMLhXalYRmr4XSsKKtMXqatA2bCU7Cq9Y0nLDSsSKtMXnil7QPE7d4JWtX6xhY1DQlhlZcvafsAoWJVezEe05hCsACrfP6Cto83zp0OUata3/jwKynKysBSGpSBvLGffCZs9cP48CcJZZWXnykDeWONY5G1si6GOze9yA5Lj8DSXA8Vq9qL+eFfcyirfPkfXR9vhl0aVv2f5qf3kFb5skAXyBvjmXrSVta10HMxDLXKlxnq4fV7HeJWdsM67iGttJbFzu1he0DeqlazPvwEw6ossDNMs97nJvCsXqwNJu0qK9KqLLAzb0GhXb3YD95b18Joq7LAzg0PZDMZUlZW946wKgvsrHuAYm2yb685m7ye53CsypVbmj7eDGFYm6wZfjofbd7qIK3KFWZupes8Qav+yw93S4gGplW5wkxVOgliBa2iNrPAter3X2q/vLtnFHN4VgxhNQNYWFbGekh/+qF5ean9OAI3pD7BtSpXFEo2gQSw0FaqKhZ+/Bo1m3XsBDZEnJbwrdjFQlqp4rfRyptB3klLWLGDBW4VhrRSxfbq22ZeXeP27YxhNRH7qoFW4sPqVE/Xkqdwx7BiFAtpteKeV43X43+SRRUyiAyxYhMr68PyWamq7wULV0+//3z259z8Gcx1UZKknjMyim/FDpanzkJYgZv8To9bs9ns8MCIvjz74KMnYetEkQPuMCt2sOrwPeggVqKnXT21ZoeHB4eW1YFL5k/o6tolrNgpSofQPehgVm5/9frXaFKkrCplij5A7BtplJVnX9E/5tlHzIpjZ2Vp2J5OvlpUtDus6eEhrlXEqm2sYtQ+C9mZC+Px6va29d+nMxOLnFVFeKMK5M0iiz4HC07DapC3qjA0Jf09i2Hl7N9+aJ+E5Kwqyh1NHyBtHm3l7O37G2oV3bmvalVR2Jk3HPFoK3vX6KsZBasKQzPSTR5tZdcNn5e3Qq2CRFtxzNSkWqElIq0KqrkHw3RGw4pjp3LQagekld1l/UfFiqGL4c7OA9LKLhz+HlKw4hSWliuPeZSV1b83ZjSsuDllHyATHmVlvVPoeUbDimNmPtqIiLT6ZPw/rcvasFUZYqWcUuYB84CysrB+r2CFP+Dux5qzU2Xp0cvS6HlnE+vPwfqsogdlPFaMnYX6eYiYozexPtOwYujG0MzDLmI9g4nVWs0Ke7DPa8UxM/5up6lGW8GwSFmxVJGa+bAbvU4miEXIir2GpXfxkVZBLGJWbNUNZqKtAlgwq3UOythWHDPzOt6MxCgrPxYxqzk7w37efIqysrE+ErZS2FnTDWQoRliBLYuYlcBaPerEOhGhVmisjVgxs0g5mLYaarXvxdpa6XlQQ9che7AirdY0KGP0V8yeg2YeOiFW+24HT8pqzmjf7qYtwq1cLEJWygWbNQOQUUeFWTlYRKwEhWNtpCEkj6IatIrCgljlnPiZIDc4HNirK4ryxtLWBNEZ/ux0VHW/ADxfEo4FsSqeROYiIrdvpyxN5eCk+etbwXq+xHrIJBQL1q5Y28OJToJYsP5qi2UkgAXt23tbLD1+LPh1cNuyjLRwrLZYZlo4VqXM+an99o5Tz5s8Tq24f31v173l0sKx0oorGRIhEAanItaZFpYV7oA7Q1tbbCJQLFyrwE1O0rGKa7RKPNY6rSoCi7Nc60trnVYsPQqwibTWaZV4rOIardKBFVa4R1sZpRUw0pcGrFhWQvny+fnuC8CV9A6+GNNKsauESyVNLSuelTv7cOdqMbTf2ibSKsY7B73TD1/sM5FLD9YyfTs4s6zYEzlJxyrFug6CHfmbkA6s64gCK7y+8r0p4FSw5r4SjnVewrHyD8oo4Pu+jC6eSz7W11IMK1jL4lKAddyLM9jnq6e0PotLA9ZV4B05OAOjvo0zFWemPtlYO8VSnEFk4HL4JjgrZd7J6o+4Oe7FsKpUPI+i3jgNi5uz+aLH9QXXyjco40zkvLlWHNOrINeR58C7TDAnJ4TLu+e7N0VwrebvZ2FR3HzFeOcEfBBZUQQPFcPLtteYa5z3KMAGRoE1a1r3ztbzqRuKpbWiFaPPmaw959IarJK9zsGTGym3mpXCJb1q8OTqRF7Fas7ORmtEcirLsZ8GuE1Jd+XJaU6Wl7cS5rep6a2AvH6RZTm/hJWgcJcp6qz8eb7UF66VoTeEgJVWks5vb9J3/vnSeL48lxVBFuRK0IozVvgpysX7exZgc2lcPd1c/ru90GHcCOWTf283d68pPvUQaTQa0+lU+0n7i2yzDaH8D9ae1v0+vGQPAAAAAElFTkSuQmCC)](https://nodesource.com/products/nsolid)


## Project Idea

The project's goal is to scrape and process information from the Market Watch portal to capture data related to the performance and competitors of a specific stock. Additionally, it will communicate with the Polygon API to find information such as the stock's status and open/close prices. The code is developed in Python using the FastAPI framework to build an API with two available endpoints. The first is a GET endpoint that returns general information about a stock. The second endpoint is for registering purchased stocks and the acquired quantity. For example, when checking the details of a stock purchase via the GET endpoint, it will show that a purchase was made and the quantity of shares acquired.

## Crawler Structure
For the web scraping component, the code uses the requests and BeautifulSoup libraries to interact with and make available the information by directly requesting the HTML code of the page, simulating the behavior of a human agent. The header below is an example:

```
{
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.109 Safari/537.36",
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8",
    "Accept-Language": "en-US,en;q=0.5",
    "Accept-Encoding": "gzip, deflate, br",
    "Referer": "https://www.google.com.br/"
}
```

In the code above, several important fields can be noted, such as "Referer," which indicates the point of origin or the site from which access to the application was initiated. This helps avoid blocks that the bot might face. The "Accept" line defines the type of response that is accepted/expected when making a request. Without these details, the bot's communication might be blocked by a Captcha or by the site's robots.txt, which allows access to only some endpoints.

## Alternative Sources
As an alternative for scenarios where blocking occurs, I created another path where information is fetched from two portals: MarketBeat, which follows a similar process as MarketWatch, downloading the HTML to return information about competitors and the market cap of each, and the Yahoo Finance API to retrieve performance data as expected.

## Data Unification
Finally, the scraped information is unified to ensure that the data returned does not break and is as accurate as possible.

## Tech

- Python - Utilized as the primary programming language for development, offering versatility and extensive library support.
- FastAPI - Implemented as the web framework for building a high-performance API, leveraging asynchronous features for better handling of concurrent requests.
- PostgreSQL - Employed as the relational database management system (RDBMS) for storing and managing structured data efficiently, offering powerful querying capabilities.
- BeautifulSoup - Used to parse and extract data from HTML content, in conjunction with the requests library, to simulate browser-like requests for web scraping tasks.
- Docker - Utilized for containerization, enabling consistent and isolated environments for deployment and execution, ensuring easy scalability and management across different platforms.

# Installation

### Prerequisites
To run this application using Docker, make sure you have the following installed:

- Docker: Verify that Docker is installed by running:
```
docker --version
```
If Docker is not installed, download and install it from the official Docker website.
- Docker Compose (Optional but recommended if using docker-compose.yml). Check if Docker Compose is installed:
```
docker-compose --version
```
If not installed, follow the instructions on the Docker Compose website.
### Steps to Run the Project
- Clone the Repository:

Open a terminal and clone the repository
```
git clone https://github.com/your-username/your-repository.git
```

 - Build the Docker Image:
```
docker build -t fastapi_app .
```
- Run the Docker Compose. This command will set up the database and application, making sure all services are running.:
```
docker-compose up -d
```
- Access the FastAPI Application:
```
The FastAPI endpoint will be available at http://localhost:8000.
You can access the interactive API documentation at http://localhost:8000/docs.
```
- Verify Database Connection. The PostgreSQL database is set to use port 5432. Ensure this port is available on your host machine.